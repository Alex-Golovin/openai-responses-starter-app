–¢–ó: MVP ¬´–ù–æ—Ç–∞—Ä—ñ–∞–ª—å–Ω–∏–π AI-–ø–æ–º—ñ—á–Ω–∏–∫¬ª –Ω–∞ –±–∞–∑–µ openai-responses-starter-app

‚ö†Ô∏è –ü—Ä–∞—Ü—é—î–º–æ –ø–æ–µ—Ç–∞–ø–Ω–æ: –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ–≥–æ –µ—Ç–∞–ø—É –∑—É–ø–∏–Ω—è—î–º–æ—Å—è, –≤—Ä—É—á–Ω—É –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (UI, –ª–æ–≥–∏, –∫–æ–Ω—Å–æ–ª—å), —É–∑–≥–æ–¥–∂—É—î–º–æ –∑ –∫–æ–º–∞–Ω–¥–æ—é —ñ —Ç—ñ–ª—å–∫–∏ –ø–æ—Ç—ñ–º —Ä—É—Ö–∞—î–º–æ—Å—å –¥–∞–ª—ñ. –¢–∞–∫ —Ç–µ–º–ø –±—É–¥–µ —Ç—Ä–æ—Ö–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–∏–π, –∑–∞—Ç–µ –∑–º—ñ–Ω–∏ –∑–∞–ª–∏—à–∞—Ç—å—Å—è –∫–µ—Ä–æ–≤–∞–Ω–∏–º–∏, –∞ —Ä–µ–≤ º—é ‚Äî –ø—ñ–¥–π–æ–º–Ω–∏–º.
‚ÑπÔ∏è –ü—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –±—É–¥—å-—è–∫–æ—ó –∑–∞–¥–∞—á—ñ –≤ —á–µ–∫–ª—ñ—Å—Ç–∞—Ö –æ–±–æ–≤ º—è–∑–∫–æ–≤–æ –≤—Ä—É—á–Ω—É –∑–º—ñ–Ω—é—î–º–æ `[ ]` –Ω–∞ `[x]`, —â–æ–± –ø—Ä–æ–≥—Ä–µ—Å –±—É–ª–æ –≤–∏–¥–Ω–æ —É –¥–∏—Ñ–∞—Ö.

–¶–µ–ª—å

–í–Ω—É—Ç—Ä–∏ —Å—Ç–∞—Ä—Ç–µ—Ä–∞ –ø–æ–ª—É—á–∏—Ç—å —Ä–∞–±–æ—á–∏–π —á–∞—Ç, –≥–¥–µ:
	‚Ä¢	–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å ‚Üí –º—ã —á–µ—Ä–µ–∑ File Search –≤—ã–±–∏—Ä–∞–µ–º —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—É—é —Ç–µ–º—É/–∑–Ω–∞–Ω–∏—è –∏ –æ—Ç–≤–µ—á–∞–µ–º,
	‚Ä¢	–µ—Å–ª–∏ —Ç–µ–º–∞ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ ‚Üí –ø—Ä–æ—Å–∏–º –∑–∞–≥—Ä—É–∑–∏—Ç—å ‚Üí –∏–∑–≤–ª–µ–∫–∞–µ–º –ø–æ–ª—è (Responses structured outputs) ‚Üí –ø—Ä–æ–≥–æ–Ω—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚Üí –æ—Ç–¥–∞—ë–º –≤—ã–≤–æ–¥ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏,
	‚Ä¢	—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞ ‚Äî —É OpenAI; —É –Ω–∞—Å ‚Äî —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω-–¥–∞–Ω–Ω—ã–µ (—Ç–µ–º—ã/–¥–æ–∫-—à–∞–±–ª–æ–Ω—ã/–ø–æ–ª—è/—á–µ–∫–∏).

–°—Ç–µ–∫
	‚Ä¢	Base: openai/openai-responses-starter-app (Next.js + Responses API + File Search)  Ôøº
	‚Ä¢	DB: MongoDB (Mongoose) ‚Äî —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω —Å—É—â–Ω–æ—Å—Ç–∏
	‚Ä¢	OpenAI: Responses API (+ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π File Search / Vector Store)  Ôøº
	‚Ä¢	(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) Agents SDK –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –∏ —Ö—ç–Ω–¥-–æ—Ñ—Ñ–æ–≤ –º–µ–∂–¥—É —Ç—É–ª–∑–∞–º–∏  Ôøº

–ß—Ç–æ –∫–ª–∞–¥—ë–º –≤ Vector Store (RAG)

–¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç –∑–Ω–∞–Ω–∏–π: FAQ, —á–µ–∫-–ª–∏—Å—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –ø—Ä–∞–≤–∏–ª–∞/–ø–æ—è—Å–Ω–µ–Ω–∏—è, –∞–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω—ã (–∫–æ—Ä–æ—Ç–∫–∏–µ —á–∞–Ω–∫–∏ —Å metadata: { topicId, kind, title }). –õ–æ–≥–∏–∫—É (documents/fields/checks) –Ω–µ –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ–º ‚Äî –æ–Ω–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–¥–æ–º.  Ôøº

–ê–≥–µ–Ω—Ç –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
	‚Ä¢	File Search (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π) ‚Äî –∏—â–µ—Ç –ø–æ –Ω–∞—à–µ–º—É Vector Store
	‚Ä¢	parse_files ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–ª–µ–π –∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ Responses structured outputs
	‚Ä¢	run_checks ‚Äî –¥–≤–∏–∂–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø–æ –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã–º –ø–æ–ª—è–º
	‚Ä¢	render_response ‚Äî —Å–±–æ—Ä–∫–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ (–∏ –≤—Å—Ç–∞–≤–∫–∞ 1‚Äì2 –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ü–∏—Ç–∞—Ç –∏–∑ File Search)
	‚Ä¢	book_consultation ‚Äî –∑–∞–≥–ª—É—à–∫–∞ –ø–æ–¥ CRM (–≤—ã–∑–æ–≤ API –ø–æ–∑–∂–µ)
	‚Ä¢	choose_topic_via_search –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç—É–ª –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω: –¥–µ–ª–∞–µ–º –≤—ã–±–æ—Ä —Ç–µ–º—ã –ø–æ –∏—Ç–æ–≥–∞–º File Search (–ø–æ —á–∞—Å—Ç–æ—Ç–µ topicId –≤ top-k). –ï—Å–ª–∏ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ ‚Äî –∞–≥–µ–Ω—Ç –∑–∞–¥–∞—ë—Ç –æ–¥–∏–Ω —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å.

System Prompt (–≤—Å—Ç–∞–≤–∏—Ç—å –≤ —Å—Ç–∞—Ä—Ç–µ—Ä)

(—É–∫—Ä.)

–¢–∏ ‚Äî —Ü–∏—Ñ—Ä–æ–≤–∏–π –ø–æ–º—ñ—á–Ω–∏–∫ –Ω–æ—Ç–∞—Ä—ñ—É—Å–∞ (–º. –†—ñ–≤–Ω–µ). –ü—Ä–∞—Ü—é–π –∫—Ä–æ–∫–∞–º–∏, —á–µ–º–Ω–æ, –±–µ–∑ –≤–∏–≥–∞–¥–æ–∫.

1) –í–∏–∑–Ω–∞—á —Ç–µ–º—É: –∑–∞–ø—É—Å—Ç–∏ File Search –∑–∞ —Ç–µ–∫—Å—Ç–æ–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞; –æ–±–µ—Ä–∏ topicId –∑ –Ω–∞–π–±—ñ–ª—å—à–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é –∑–±—ñ–≥—ñ–≤ —Å–µ—Ä–µ–¥ top-k. –Ø–∫—â–æ –ª—ñ–¥–µ—Ä–∞ –Ω–µ–º–∞ ‚Äî –ø–æ—Å—Ç–∞–≤ 1 —É—Ç–æ—á–Ω–µ–Ω–Ω—è —ñ –ø–æ–≤—Ç–æ—Ä–∏.
2) –Ø–∫—â–æ —Ç–µ–º–∞ –±–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ ‚Äî –¥–∞–π –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∑ FAQ/—á–µ–∫-–ª–∏—Å—Ç–æ–º (2‚Äì6 —Ä–µ—á–µ–Ω—å). –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏ ‚Äî –∫–æ—Ä–æ—Ç–∫–æ –ø–æ—è—Å–Ω–∏ –ø–µ—Ä–µ–ª—ñ–∫ —ñ –ø–æ–ø—Ä–æ—Å–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª–∏. –î–æ–∑–≤–æ–ª—å –∫—ñ–ª—å–∫–∞ —Ñ–∞–π–ª—ñ–≤; –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–ø–∏—à–µ ¬´–≥–æ—Ç–æ–≤–æ¬ª –∞–±–æ –º–∏–Ω–µ –ø–∞—É–∑–∞ ‚Äî –ø–µ—Ä–µ—Ö–æ–¥—å –¥–æ –∞–Ω–∞–ª—ñ–∑—É.
3) –í–∏–¥–æ–±—É—Ç–æ–∫ –¥–∞–Ω–∏—Ö: –≤–∏—Ç—è–≥–Ω–∏ –ø–æ–ª—è –∑ —Ñ–∞–π–ª—ñ–≤ –∑–∞ —Å—Ö–µ–º–æ—é –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ —Ç–µ–º–∏ (parse_files).
4) –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏: –∑–∞—Å—Ç–æ—Å—É–π –ø—Ä–∞–≤–∏–ª–∞ —Ç–µ–º–∏ (run_checks) —ñ —Å—Ñ–æ—Ä–º—É–π –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è/–¥—ñ—ó.
5) –í—ñ–¥–ø–æ–≤—ñ–¥—å: —è–∫—â–æ –±—Ä–∞–∫—É—î ‚Äî –≤–∏–≤–µ–¥–∏ —Å–ø–∏—Å–æ–∫; —è–∫—â–æ –≤—Å–µ –≥–∞—Ä–∞–∑–¥ ‚Äî –ø—ñ–¥—Ç–≤–µ—Ä–¥—å; —è–∫—â–æ —î –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è ‚Äî –∫–æ—Ä–æ—Ç–∫–æ —â–æ –Ω–µ —Ç–∞–∫ —ñ —â–æ —Ä–æ–±–∏—Ç–∏. –î–æ–¥–∞–π 1‚Äì2 –∫–æ—Ä–æ—Ç–∫—ñ —Ü–∏—Ç–∞—Ç–∏ –∑ File Search. –Ø–∫—â–æ –ø–∏—Ç–∞–Ω–Ω—è –ø–æ–∑–∞ –º–µ–∂–∞–º–∏ –∑–Ω–∞–Ω—å ‚Äî –∑–∞–ø—Ä–æ–ø–æ–Ω—É–π –∑–∞–ª—É—á–∏—Ç–∏ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞-–ª—é–¥–∏–Ω—É.


‚∏ª

–ú–æ–¥–µ–ª–∏ MongoDB (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω-–¥–∞–Ω–Ω—ã–µ)

// models/Field.ts
import { Schema, model } from 'mongoose'

export const Field = model('Field', new Schema({
  key: { type: String, required: true, unique: true }, // full_name, id_code...
  label: { type: String, required: true },
  type: { type: String, enum: ['string','number','boolean','date','enum'], required: true },
  options: [String],
  extractHint: String,
  validators: [Object] // { type:'regex'|'min_length'|'forbid_patterns'|'date_before', value:any }
}, { timestamps: true }))

// models/DocumentTemplate.ts
import { Schema, model, Types } from 'mongoose'

export const DocumentTemplate = model('DocumentTemplate', new Schema({
  name: { type: String, required: true, unique: true }, // –ü–∞—Å–ø–æ—Ä—Ç, –ü—Ä–∞–≤–æ –≤–ª–∞—Å–Ω–æ—Å—Ç—ñ...
  fieldIds: [{ type: Schema.Types.ObjectId, ref: 'Field', required: true }]
}, { timestamps: true }))

// models/Check.ts
import { Schema, model } from 'mongoose'

export const Check = model('Check', new Schema({
  description: { type: String, required: true },
  type: { type: String, enum: ['single_doc','cross_doc'], required: true },
  whenExpr: String,                       // "passport.marital_status == '–æ–¥—Ä—É–∂–µ–Ω–∏–π/–∑–∞–º—ñ–∂–Ω—è'"
  docTemplateId: { type: Schema.Types.ObjectId, ref: 'DocumentTemplate' },
  rules: [{ type: Object, required: true }], // [{type:'forbid_patterns', field:'fld_powers_text', value:['–∑ –ø–∏—Ç–∞–Ω—å']}]
  severity: { type: String, enum: ['low','medium','high'], default: 'medium' },
  onFail: String
}, { timestamps: true }))

// models/Topic.ts
import { Schema, model } from 'mongoose'

export const Topic = model('Topic', new Schema({
  title: { type: String, required: true },
  tags: [String],
  faq: [{ q: String, a: String }],
  documents: [{
    templateId: { type: Schema.Types.ObjectId, ref: 'DocumentTemplate', required: true },
    alias: { type: String, required: true },     // passport_seller, poa_text...
    required: { type: Boolean, default: true }
  }],
  checkIds: [{ type: Schema.Types.ObjectId, ref: 'Check' }],
  responses: { type: Object } // { missing_docs, analysis_ok, analysis_findings }
}, { timestamps: true }))


‚∏ª

–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç–∞—Ä—Ç–µ—Ä–µ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã)

Admin UI (–ø—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞)
	‚Ä¢	/admin ‚Äî –æ–¥–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Å–µ–∫—Ü–∏—è–º–∏/–≤–∫–ª–∞–¥–∫–∞–º–∏:
	‚Ä¢	Topics: —Å–ø–∏—Å–æ–∫ + —Ñ–æ—Ä–º–∞ (title, tags, faq[], documents[], checkIds[], responses)
	‚Ä¢	Document Templates: –∏–º—è + –≤—ã–±–æ—Ä Field
	‚Ä¢	Fields: key/label/type/validators
	‚Ä¢	Checks: description/type/whenExpr/docTemplateId/rules/severity/onFail
	‚Ä¢	–•—Ä–∞–Ω–µ–Ω–∏–µ ‚Äî MongoDB —á–µ—Ä–µ–∑ API-—Ä–æ—É—Ç—ã (Next.js route handlers)

Chat UI
	‚Ä¢	–æ—Å—Ç–∞–≤–ª—è–µ–º —à—Ç–∞—Ç–Ω—ã–π —á–∞—Ç –∏–∑ —Å—Ç–∞—Ä—Ç–µ—Ä–∞, –≤–∫–ª—é—á—ë–Ω–Ω—ã–π File Search
	‚Ä¢	–ê–Ω–∞–ª—ñ–∑ —Å—Ç–∞—Ä—Ç—É—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ (–±–µ–∑ –∫–Ω–æ–ø–∫–∏ ¬´–ì–æ—Ç–æ–≤–æ¬ª): —è–∫—â–æ –≤—Å—ñ –æ–±–æ–≤ º—è–∑–∫–æ–≤—ñ —Ñ–∞–π–ª–∏ –Ω–∞–¥—ñ–π—à–ª–∏ ‚Äî –ø–æ—á–∏–Ω–∞—î–º–æ –≤—ñ–¥—Ä–∞–∑—É; —è–∫—â–æ –Ω—ñ ‚Äî —á–µ–∫–∞—î–º–æ –∫–æ—Ä–æ—Ç–∫—É ¬´–º º—è–∫—É¬ª –ø–∞—É–∑—É (–¥–µ—Ñ–æ–ª—Ç 45 c) —ñ —Å—Ç–∞—Ä—Ç—É—î–º–æ –∑ —Ç–∏–º, —â–æ —î
	‚Ä¢	–ü—Ä–æ–º—ñ–∂–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ–≥—Ä–µ—Å—É: ¬´‚úÖ –æ—Ç—Ä–∏–º–∞–≤ –ø–∞—Å–ø–æ—Ä—Ç‚Ä¶¬ª, ¬´üïí –æ—á—ñ–∫—É—é –Ω–æ–≤—ñ —Ñ–∞–π–ª–∏ 45 c‚Ä¶¬ª, ¬´üîé –ø–æ—á–∏–Ω–∞—é –∞–Ω–∞–ª—ñ–∑‚Ä¶¬ª, ¬´üìÑ –æ–±—Ä–æ–±–∫–∞: —Ç–µ–∫—Å—Ç –¥–æ–≤—ñ—Ä–µ–Ω–æ—Å—Ç—ñ (2/3)‚Ä¶¬ª, ¬´‚è∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∞–Ω–∞–ª—ñ–∑—É —á–µ—Ä–µ–∑ –Ω–æ–≤–∏–π —Ñ–∞–π–ª‚Ä¶¬ª

‚∏ª

–°–µ—Ä–≤–µ—Ä–Ω—ã–µ route handlers (Next.js /app/api)
	‚Ä¢	POST /api/admin/fields / GET ‚Ä¶ / PUT ‚Ä¶/:id / DELETE ‚Ä¶/:id
	‚Ä¢	POST /api/admin/document-templates ‚Ä¶
	‚Ä¢	POST /api/admin/checks ‚Ä¶
	‚Ä¢	POST /api/admin/topics ‚Ä¶
	‚Ä¢	POST /api/runtime/choose-topic
–í—Ö–æ–¥: { userText }
–î–µ–π—Å—Ç–≤–∏–µ: –≤—ã–∑–≤–∞—Ç—å File Search (top-k=5), –ø–æ—Å—á–∏—Ç–∞—Ç—å —á–∞—Å—Ç–æ—Ç—ã metadata.topicId, –≤–µ—Ä–Ω—É—Ç—å –ª–∏–¥–µ—Ä–∞ –∏–ª–∏ 2‚Äì3 –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
	‚Ä¢	POST /api/runtime/parse-files
–í—Ö–æ–¥: { files:[{openaiFileId, alias}], documentTemplateId }
–î–µ–π—Å—Ç–≤–∏–µ: Responses structured outputs –ø–æ Field —É —à–∞–±–ª–æ–Ω–∞ ‚Üí [{ fieldKey, value, confidence }]
	‚Ä¢	POST /api/runtime/run-checks
–í—Ö–æ–¥: { topicId, extracted: [{alias, fieldKey, value}] }
–î–µ–π—Å—Ç–≤–∏–µ: –∏—Å–ø–æ–ª–Ω—è–µ–º –ø—Ä–∞–≤–∏–ª–∞ ‚Üí { findings:[], actions:[], missingDocs:[] }
	‚Ä¢	POST /api/runtime/render-response
–í—Ö–æ–¥: { topicId, result, userQuestion }
–î–µ–π—Å—Ç–≤–∏–µ: —Å–æ–±—Ä–∞—Ç—å —Ç–µ–∫—Å—Ç –∏–∑ Topic.responses + 1‚Äì2 –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –∏–∑ File Search (—Ñ–∏–ª—å—Ç—Ä –ø–æ topicId)
	‚Ä¢	POST /api/knowledge/reindex
–ê–¥–º–∏–Ω-–¥–µ–π—Å—Ç–≤–∏–µ: –ø–æ–≤–Ω–∞ –ø–µ—Ä–µ–±—É–¥–æ–≤–∞ –±–∞–∑–∏ –∑–Ω–∞–Ω—å —É Vector Store –∑ Mongo (topics ‚Üí —á–∞–Ω–∫–∏ ‚Üí –∞–ø–ª–æ–∞–¥)
	‚Ä¢	POST /api/knowledge/upsert-topic/:id
–¢–æ—á–∫–æ–≤–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: –ø–µ—Ä–µ–±—É–¥—É–≤–∞—Ç–∏ —Ç–∞ –æ–Ω–æ–≤–∏—Ç–∏ —á–∞–Ω–∫–∏ –ª–∏—à–µ –¥–ª—è –æ–¥–Ω—ñ—î—ó —Ç–µ–º–∏

–ï—Å–ª–∏ –ø–æ–∑–∂–µ –Ω—É–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ—Ä–∞, –≤ –∫–æ–¥–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –º–∞—Å—Å–∏–≤ vector_store_ids (UI –ø—Ä–∏–¥—ë—Ç—Å—è —Ä–∞—Å—à–∏—Ä–∏—Ç—å).  Ôøº

‚∏ª

–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Vector Store —Å MongoDB

	‚Ä¢	–ò—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã: MongoDB (Topics, Document Templates, Fields, Checks). –£ Vector Store —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π (FAQ, —á–µ–∫-–ª–∏—Å—Ç—ã, –ø—Ä–∞–≤–∏–ª–∞/–ø–æ—è—Å–Ω–µ–Ω–∏—è, –∞–Ω—Ç–∏-–ø–∞—Ç–µ—Ä–Ω–∏) —Å metadata: { topicId, kind, title }.
	‚Ä¢	–°—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–∞ MVP:
		‚Äì –ü—Ä–∞—Ü—é—î–º–æ –∑ –æ–¥–Ω–∏–º Vector Store (`vs_68d58c14130081919fa83aeee14f6a7d`); id –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó (env/–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞).
		‚Äì –ü–µ—Ä–µ–±—É–¥–æ–≤–∞ knowledge: `buildChunksFromMongo` —Ñ–æ—Ä–º—É—î —á–∞–Ω–∫–∏ —Ç–∞ –æ–¥—Ä–∞–∑—É –∞–ø–ª–æ—É–¥–∏—Ç—å —ó—Ö —É Vector Store —á–µ—Ä–µ–∑ `POST /api/knowledge/reindex` (–±–µ–∑ –ø—Ä–æ–º—ñ–∂–Ω–æ–≥–æ knowledge.jsonl).
		‚Äì –ß–∞–Ω–∫–µ—Ä: 300‚Äì800 —Ç–æ–∫–µ–Ω—ñ–≤; –±–µ–∑ –∑–∞–π–≤–æ–≥–æ —à—É–º—É; —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é. –ú–µ—Ç–∞–¥–∞–Ω—ñ –∫–æ–∂–Ω–æ–≥–æ —á–∞–Ω–∫–∞: { topicId, kind: 'faq'|'checklist'|'rule'|'pattern', title }.
	‚Ä¢	–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–∞–Ω–∫–æ–≤ (buildChunksFromTopic):
		‚Äì FAQ: –Ω–∞ –∫–∞–∂–¥—É—é –ø–∞—Ä—É q/a ‚Üí –æ—Ç–¥–µ–ª—å–Ω—ã–π —á–∞–Ω–∫ kind:'faq'
		‚Äì –î–æ–∫—É–º–µ–Ω—Ç—ã: –∏–∑ topic.documents —Å–æ–±—Ä–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π —á–µ–∫-–ª–∏—Å—Ç ‚Üí kind:'checklist'
		‚Äì –ü—Ä–∞–≤–∏–ª–∞/–ø–æ—è—Å–Ω–µ–Ω–Ω—è: —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è –∏–∑ –∞–¥–º–∏–Ω–∫–∏ ‚Üí kind:'rule'
		‚Äì –ê–Ω—Ç–∏–ø–∞—Ç–µ—Ä–Ω–∏/–ø—Ä–∞–≤–∏–ª—å–Ω—ñ —Ñ–æ—Ä–º—É–ª—é–≤–∞–Ω–Ω—è: –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ ‚Üí kind:'pattern'
		‚Äì –ù–ï –≤–∫–ª—é—á–∞–µ–º checks –∏ JSON-—Å—Ö–µ–º—ã ‚Äî –æ–Ω–∏ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –ë–î/–∫–æ–¥–µ –∏ –∏—Å–ø–æ–ª–Ω—è—é—Ç—Å—è —Ä–∞–Ω—Ç–∞–π–º–æ–º.
	‚Ä¢	API —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
		‚Äì POST /api/knowledge/reindex ‚Üí full rebuild
		‚Äì POST /api/knowledge/upsert-topic/:id ‚Üí –∞–ø—Å–µ—Ä—Ç–æ–º –æ–±–Ω–æ–≤–∏—Ç—å —á–∞–Ω–∫–∏ –æ–¥–Ω–æ–π —Ç–µ–º—ã
		‚Äì (–ø–æ–∑–∂–µ) DELETE /api/knowledge/remove-topic/:id
	‚Ä¢	–•—Ä–∞–Ω–µ–Ω–∏–µ —Å–≤—è–∑–æ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
		‚Äì –í Topic –¥–µ—Ä–∂–∞—Ç—å service-–ø–æ–ª–µ knowledgeRefs: [{ chunkId, hashing }], —á—Ç–æ–±—ã –¥–µ–ª–∞—Ç—å –¥–∏—Ñ—Ñ-–∞–ø—Å–µ—Ä—Ç—ã
		‚Äì –î–ª—è MVP –º–æ–∂–Ω–æ –±–µ–∑ —ç—Ç–æ–≥–æ ‚Äî —Ç–æ–ª—å–∫–æ ¬´Reindex¬ª
	‚Ä¢	–ú—É–ª—å—Ç–∏-store (–ø–æ–∑–∂–µ): –∫–æ–¥ —É–∂–µ —É–º–µ–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –º–∞—Å—Å–∏–≤ vector_store_ids; UI-–º—É–ª—å—Ç–∏–≤—ã–±–æ—Ä –¥–æ–±–∞–≤–∏–º –ø–æ—Å–ª–µ MVP.

‚∏ª

–†–∞–±–æ—á–∏–π –ø–æ—Ç–æ–∫ –≤ —á–∞—Ç–µ (–æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π ‚Äî –±–µ–∑ –∫–Ω–æ–ø–∫–∏ ¬´–ì–æ—Ç–æ–≤–æ¬ª, —Å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏)

	–ö–æ–Ω—Ñ–∏–≥
	```
	COLLECT_DEBOUNCE_MS = 45000   // ¬´–º º—è–∫–∞¬ª –ø–∞—É–∑–∞ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤; 0 ‚Äî –≤–∏–º–∫–Ω—É—Ç–∏
	PROGRESS_UPDATES = true       // –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –ø—Ä–æ–º—ñ–∂–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
	RESTART_ON_NEW_FILE = true    // —è–∫—â–æ –ø—ñ–¥ —á–∞—Å –∞–Ω–∞–ª—ñ–∑—É –ø—Ä–∏–π—à–æ–≤ –Ω–æ–≤–∏–π —Ñ–∞–π–ª ‚Äî –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç–∏
	```

	–°—Ç–∞–Ω –º–∞—à–∏–Ω–∏
	```
	idle ‚Üí topic_selected ‚Üí collecting_files ‚Üí analyzing ‚Üí awaiting_followups
	```

	–ü–æ–¥—ñ—ó –π –ø–µ—Ä–µ—Ö–æ–¥–∏

	1) –ü–µ—Ä—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (text)
		‚Ä¢ File Search ‚Üí top-k ‚Üí –≤–∏–±—ñ—Ä topicId –∑–∞ –¥–æ–º—ñ–Ω—É—é—á–∏–º metadata.topicId
		‚Ä¢ —è–∫—â–æ –ª—ñ–¥–µ—Ä–∞ –Ω–µ–º–∞ ‚Äî 1 —É—Ç–æ—á–Ω–µ–Ω–Ω—è —ñ –ø–æ–≤—Ç–æ—Ä –ø–æ—à—É–∫—É
		‚Ä¢ —è–∫—â–æ —É —Ç–µ–º–∏ –Ω–µ–º–∞—î –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ ‚Üí –æ–¥—Ä–∞–∑—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å (FAQ/—á–µ–∫-–ª–∏—Å—Ç) + 1‚Äì2 —Ü–∏—Ç–∞—Ç–∏ –∑ File Search ‚Üí phase=awaiting_followups
		‚Ä¢ —è–∫—â–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏ —î ‚Üí –≤–∏–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ alias+–Ω–∞–∑–≤; phase=collecting_files
			‚Äì —è–∫—â–æ PROGRESS_UPDATES: ¬´–ì–æ—Ç–æ–≤–∏–π –ø—Ä–∏–π–º–∞—Ç–∏ —Ñ–∞–π–ª–∏: ‚Ä¶¬ª

	2) –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É
		‚Ä¢ –∑–±–µ—Ä–µ–≥—Ç–∏ openaiFileId –ø—ñ–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º alias
		‚Ä¢ –ø—Ä–æ–º—ñ–∂–Ω–µ: ¬´‚úÖ –æ—Ç—Ä–∏–º–∞–≤ *–ø–∞—Å–ø–æ—Ä—Ç –¥–æ–≤—ñ—Ä–∏—Ç–µ–ª—è*¬ª
		‚Ä¢ —è–∫—â–æ –≤—Å—ñ required alias –ø—Ä–∏—Å—É—Ç–Ω—ñ ‚Üí startAnalysis() —á–µ—Ä–µ–∑ 1‚Äì2 —Å–µ–∫
		‚Ä¢ —ñ–Ω–∞–∫—à–µ, —è–∫—â–æ COLLECT_DEBOUNCE_MS>0: –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–∞–π–º–µ—Ä –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è (45 —Å –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)

	3) –¢–µ–∫—Å—Ç –ø—ñ–¥ —á–∞—Å collecting_files
		‚Ä¢ –Ω–µ —Å—Ç–∞—Ä—Ç—É—î–º–æ –∞–Ω–∞–ª—ñ–∑ –æ–¥—Ä–∞–∑—É
		‚Ä¢ —è–∫—â–æ —Ñ—Ä–∞–∑–∞ —Ç–∏–ø—É ¬´–ø–æ—á–∏–Ω–∞–π/–ø–µ—Ä–µ–≤—ñ—Ä—è–π/–≥–æ—Ç–æ–≤–æ¬ª ‚Äî startAnalysis() –Ω–µ–≥–∞–π–Ω–æ
		‚Ä¢ —ñ–Ω–∞–∫—à–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î–º–æ –∫–æ—Ä–æ—Ç–∫–æ, –∑–∞–ª–∏—à–∞—é—á–∏—Å—å —É collecting_files, —Ç–∞ –ø—Ä–æ–¥–æ–≤–∂—É—î–º–æ —á–µ–∫–∞—Ç–∏ —Ñ–∞–π–ª–∏

	4) –ê–≤—Ç–æ-—Å—Ç–∞—Ä—Ç –∞–Ω–∞–ª—ñ–∑—É (–±–µ–∑ –∫–Ω–æ–ø–∫–∏)
		–£–º–æ–≤–∏:
			‚Äì —É—Å—ñ –æ–±–æ–≤ º—è–∑–∫–æ–≤—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏ –Ω–∞ –º—ñ—Å—Ü—ñ; –∞–±–æ
			‚Äì –Ω–∞–¥—ñ–π—à–æ–≤ —Ö–æ—á–∞ –± –æ–¥–∏–Ω —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏–π —Ñ–∞–π–ª —ñ —Å–ø–ª–∏–≤ COLLECT_DEBOUNCE_MS
		–ö—Ä–æ–∫–∏:
			‚Äì phase=analyzing
			‚Äì –ø—Ä–æ–º—ñ–∂–Ω–µ: ¬´üîé –ü–æ—á–∏–Ω–∞—é –∞–Ω–∞–ª—ñ–∑ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤‚Ä¶¬ª
			‚Äì parse_files –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ alias ‚Üí structured outputs
				‚Ä¢ –ø—Ä–æ–≥—Ä–µ—Å: ¬´üìÑ –û–±—Ä–æ–±–∫–∞: *—Ç–µ–∫—Å—Ç –¥–æ–≤—ñ—Ä–µ–Ω–æ—Å—Ç—ñ* (2/3)‚Ä¶¬ª
			‚Äì run_checks ‚Üí findings/actions/missing
			‚Äì render_response ‚Üí —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç + –∫–æ—Ä–æ—Ç–∫—ñ —Ü–∏—Ç–∞—Ç–∏ File Search
			‚Äì phase=awaiting_followups

	5) –ù–æ–≤–∏–π —Ñ–∞–π–ª/–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—ñ–¥ —á–∞—Å analyzing
		‚Ä¢ —è–∫—â–æ —Ñ–∞–π–ª —ñ RESTART_ON_NEW_FILE=true:
			‚Äì ¬´‚è∏ –û—Ç—Ä–∏–º–∞–≤ –Ω–æ–≤–∏–π —Ñ–∞–π–ª ‚Äî –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—é –∞–Ω–∞–ª—ñ–∑¬ª
			‚Äì –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å —É collecting_files —ñ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –¥–µ–±–∞—É–Ω—Å
		‚Ä¢ —è–∫—â–æ —Ç–µ–∫—Å—Ç-—É—Ç–æ—á–Ω–µ–Ω–Ω—è ‚Äî –∑–∞—Ñ—ñ–∫—Å—É–≤–∞—Ç–∏ —Ç–∞ –≤—Ä–∞—Ö—É–≤–∞—Ç–∏ —É –Ω–∞—Å—Ç—É–ø–Ω—ñ–π —ñ—Ç–µ—Ä–∞—Ü—ñ—ó; –∑–∞ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏ –∫–æ—Ä–æ—Ç–∫–æ, –Ω–µ –ø–µ—Ä–µ—Ä–∏–≤–∞—é—á–∏ –∞–Ω–∞–ª—ñ–∑

	6) –ü—ñ—Å–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
		‚Ä¢ phase=awaiting_followups
		‚Ä¢ –Ω–æ–≤–∞ —Ç–µ–º–∞ ‚Üí –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ –∫—Ä–æ–∫—É (1)
		‚Ä¢ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø–æ –ø–æ—Ç–æ—á–Ω—ñ–π —Ç–µ–º—ñ ‚Üí collecting_files ‚Üí –∞–≤—Ç–æ-—Ü–∏–∫–ª

	–§–æ—Ä–º–∞—Ç –ø—Ä–æ–º—ñ–∂–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (–ø—Ä–∏–∫–ª–∞–¥–∏)
		‚Ä¢ ¬´‚úÖ –æ—Ç—Ä–∏–º–∞–≤ *–ø–∞—Å–ø–æ—Ä—Ç –¥–æ–≤—ñ—Ä–∏—Ç–µ–ª—è*¬ª
		‚Ä¢ ¬´üïí –û—á—ñ–∫—É—é –Ω–æ–≤—ñ —Ñ–∞–π–ª–∏ —â–µ 45 —Å‚Ä¶¬ª
		‚Ä¢ ¬´üîé –ü–æ—á–∏–Ω–∞—é –∞–Ω–∞–ª—ñ–∑‚Ä¶¬ª
		‚Ä¢ ¬´üìÑ –û–±—Ä–æ–±–∫–∞: *—Ç–µ–∫—Å—Ç –¥–æ–≤—ñ—Ä–µ–Ω–æ—Å—Ç—ñ* (2/3)‚Ä¶¬ª
		‚Ä¢ ¬´‚è∏ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∞–Ω–∞–ª—ñ–∑—É —á–µ—Ä–µ–∑ –Ω–æ–≤–∏–π —Ñ–∞–π–ª‚Ä¶¬ª

‚∏ª

–ü–æ–µ—Ç–∞–ø–Ω–∏–π –ø–ª–∞–Ω (–∫–æ–Ω—Ç—Ä–æ–ª—å –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ –µ—Ç–∞–ø—É)

–°—Ç–∞—Ç—É—Å –æ–Ω–æ–≤–ª—é—î–º–æ –≤—Ä—É—á–Ω—É –ø—ñ—Å–ª—è —Ä–µ–≤ º—é –∫–æ–∂–Ω–æ–≥–æ –µ—Ç–∞–ø—É:
- –ï—Ç–∞–ø 0 ‚Äî ‚úÖ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- –ï—Ç–∞–ø 1 ‚Äî üîÑ —É —Ä–æ–±–æ—Ç—ñ
- –ï—Ç–∞–ø 2 ‚Äî ‚úÖ dev –≥–æ—Ç–æ–≤–∏–π, –æ—á—ñ–∫—É—î —Ä—É—á–Ω–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
- –ï—Ç–∞–ø–∏ 3‚Äì7 ‚Äî —â–µ –Ω–µ —Å—Ç–∞—Ä—Ç—É–≤–∞–ª–∏

–ï—Ç–∞–ø 0. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ ‚úÖ
	‚Ä¢	[x] –ö–ª–æ–Ω—É–≤–∞—Ç–∏ openai/openai-responses-starter-app, –∑–∞–≤–µ—Å—Ç–∏ .env –∑ OPENAI_API_KEY
	‚Ä¢	[x] –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ –ª–æ–∫–∞–ª—å–Ω—É MongoDB —ñ –≤–∏—Å—Ç–∞–≤–∏—Ç–∏ MONGODB_URI
	‚Ä¢	[x] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–∏–π –∑–∞–ø—É—Å–∫ —Å—Ç–∞—Ä—Ç–µ—Ä–∞ —Ç–∞ File Search –ø–∞–Ω–µ–ª—å

–ï—Ç–∞–ø 1. –ë–∞–∑–∞ –∑–Ω–∞–Ω—å —Ç–∞ –≤–µ–∫—Ç–æ—Ä–Ω–µ —Å—Ö–æ–≤–∏—â–µ
	‚Ä¢	[x] –î–æ–¥–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥ –¥–ª—è Vector Store (`VECTOR_STORE_ID=vs_68d58c14130081919fa83aeee14f6a7d`) —ñ –ø—Ä–æ–∫–∏–Ω—É—Ç–∏ id —É File Search/—Ä–∞–Ω—Ç–∞–π–º
	‚Ä¢	[ ] –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ `buildChunksFromMongo`: —Ñ–æ—Ä–º—É—î–º–æ FAQ/—á–µ–∫-–ª–∏—Å—Ç–∏/–ø—Ä–∞–≤–∏–ª–∞/–∞–Ω—Ç–∏–ø–∞—Ç–µ—Ä–Ω–∏ –∑ Mongo
	‚Ä¢	[ ] –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ `POST /api/knowledge/reindex` ‚Äî –ø–æ–≤–Ω–∏–π –∞–ø–¥–µ–π—Ç Vector Store –∑ Mongo
	‚Ä¢	[ ] –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ `POST /api/knowledge/upsert-topic/:id` ‚Äî –∞–ø–¥–µ–π—Ç –æ–¥–Ω—ñ—î—ó —Ç–µ–º–∏
	‚Ä¢	[ ] –†—É—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞: –¥–æ–¥–∞—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –≤ Mongo (—á–µ—Ä–µ–∑ Compass/—Å–∫—Ä–∏–ø—Ç) —ñ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ File Search –ø–æ–≤–µ—Ä—Ç–∞—î —Ü–∏—Ç–∞—Ç–∏ –ø—ñ—Å–ª—è reindex

–ï—Ç–∞–ø 2. –ú–æ–¥–µ–ª—ñ MongoDB —Ç–∞ –∞–¥–º—ñ–Ω-UI
	‚Ä¢	[x] –î–æ–¥–∞—Ç–∏ –º–æ–¥–µ–ª—ñ Field, DocumentTemplate, Check, Topic (—Å—Ö–µ–º–∏ –≤–∏—â–µ)
	‚Ä¢	[x] CRUD route handlers /api/admin/... –¥–ª—è –∫–æ–∂–Ω–æ—ó —Å—É—Ç–Ω–æ—Å—Ç—ñ
	‚Ä¢	[x] /admin: –æ–¥–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∑ —Å–µ–∫—Ü—ñ—è–º–∏ (Topics, Document Templates, Fields, Checks)
	‚Ä¢	[x] /admin: –∫–Ω–æ–ø–∫–∏ ¬´Reindex¬ª —ñ ¬´–û–Ω–æ–≤–∏—Ç–∏ —Ç–µ–º—É¬ª –± º—é—Ç—å –ø–æ `/api/knowledge/*` (–±–µ–∑ —Ä—É—á–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤)
	‚Ä¢	[ ] –†—É—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞: —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤—É —Ç–µ–º—É —ñ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ –≤–æ–Ω–∞ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —Ç–∞ –ø—ñ–¥—Ç—è–≥—É—î—Ç—å—Å—è —É –±—ñ–ª–¥–µ—Ä—ñ –∑–Ω–∞–Ω—å

–ï—Ç–∞–ø 3. Runtime API –¥–ª—è –∞–≥–µ–Ω—Ç–∞
	‚Ä¢	[ ] /api/runtime/choose-topic ‚Äî –ø—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –¥–æ–º—ñ–Ω—É—é—á–æ–≥–æ topicId –∑ File Search (k=5)
	‚Ä¢	[ ] /api/runtime/parse-files ‚Äî Responses structured outputs ‚Üí { fieldKey, value }
	‚Ä¢	[ ] /api/runtime/run-checks ‚Äî –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –¥–≤–∏–≥—É–Ω –ø—Ä–∞–≤–∏–ª
	‚Ä¢	[ ] /api/runtime/render-response ‚Äî —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç + –∫–æ—Ä–æ—Ç–∫—ñ —Ü–∏—Ç–∞—Ç–∏ –∑ File Search (—Ñ—ñ–ª—å—Ç—Ä –∑–∞ topicId)
	‚Ä¢	[ ] –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω—ñ —Ç–µ—Å—Ç–∏: –ø—Ä–æ–≥–Ω–∞—Ç–∏ —Å—Ü–µ–Ω–∞—Ä—ñ–π –≤—Ä—É—á–Ω—É —á–µ—Ä–µ–∑ Postman/console

–ï—Ç–∞–ø 4. –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —á–∞—Ç-UI —Å—Ç–∞—Ä—Ç–µ—Ä–∞ (dev-–ø—ñ—Å–æ—á–Ω–∏—Ü—è)
	‚Ä¢	[ ] –ü–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ —á–∞—Ç-UI –Ω–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—é –ø—ñ—Å–æ—á–Ω–∏—Ü—é: —Å—Ö–æ–≤–∞—Ç–∏ –ø–µ—Ä–µ–º–∏–∫–∞—á—ñ —Ç—É–ª—ñ–≤, –ª–∏—à–∏—Ç–∏ –º—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è —Ç–µ—Å—Ç—ñ–≤
	‚Ä¢	[ ] –ü–µ—Ä—à–∏–π —é–∑–µ—Ä-–º–µ—Å–µ–¥–∂ –≤–∏–∫–ª–∏–∫–∞—î /runtime/choose-topic (—á–µ—Ä–µ–∑ –∞–≥–µ–Ω—Ç–Ω–∏–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä) —ñ –ø–æ–∫–∞–∑—É—î –ø–µ—Ä–µ–ª—ñ–∫ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ —Ç–µ–º–∏
	‚Ä¢	[ ] –ê–≤—Ç–æ-—Å—Ç–∞—Ä—Ç –∞–Ω–∞–ª—ñ–∑—É: –≤—Å—ñ required-—Ñ–∞–π–ª–∏ –∞–±–æ –ø–∞—É–∑–∞ COLLECT_DEBOUNCE_MS
	‚Ä¢	[ ] –ü—Ä–æ–º—ñ–∂–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ–≥—Ä–µ—Å—É –∑–≥—ñ–¥–Ω–æ –∑ ¬´–†–æ–±–æ—á–∏–º –ø–æ—Ç–æ–∫–æ–º¬ª
	‚Ä¢	[ ] –§—ñ–Ω–∞–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –±–µ–∑ —Å—Ç—Ä—ñ–º—É, –∑ —Ü–∏—Ç–∞—Ç–∞–º–∏ File Search —ñ –≤–∏—Å–Ω–æ–≤–∫–∞–º–∏
	‚Ä¢	[ ] smoke-—Ç–µ—Å—Ç: ¬´–î–æ–≤—ñ—Ä–µ–Ω—ñ—Å—Ç—å¬ª + –Ω–µ–≥–∞—Ç–∏–≤–Ω–∏–π –∫–µ–π—Å ¬´—Ñ–∞–π–ª –Ω–µ—á–∏—Ç–∞–µ–º—ã–π¬ª

–ï—Ç–∞–ø 5. –ê–≥–µ–Ω—Ç–Ω–∏–π —Ä–∞–Ω—Ç–∞–π–º —ñ —Ç—Ä–µ–π—Å–∏–Ω–≥
	‚Ä¢	[ ] –ó–∞–º—ñ–Ω–∏—Ç–∏ –ø—Ä—è–º—ñ –≤–∏–∫–ª–∏–∫–∏ Responses API –Ω–∞ Agents SDK (–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü—ñ—è —Ç—É–ª—ñ–≤, observability)
	‚Ä¢	[ ] –û–ø–∏—Å–∞—Ç–∏ parse_files, run_checks, render_response, book_consultation —è–∫ SDK tools
	‚Ä¢	[ ] –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è session_id –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ OpenAI —Ç–∞ –ø—Ä–æ–∫–∏–Ω—É—Ç–∏ –π–æ–≥–æ –≤ UI
	‚Ä¢	[ ] –ü–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ Observability/Tracing –ø–æ–∫–∞–∑—É—î –≤—Å—ñ –∫—Ä–æ–∫–∏ (AGENTS_TRACE=1)
	‚Ä¢	[ ] –†—É—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞: —Å—Ü–µ–Ω–∞—Ä—ñ—ó ¬´–î–æ–≤—ñ—Ä–µ–Ω—ñ—Å—Ç—å¬ª —ñ ¬´–ö–≤–∞—Ä—Ç–∏—Ä–∞¬ª —á–µ—Ä–µ–∑ –∞–≥–µ–Ω—Ç–Ω–∏–π —Ä–∞–Ω—Ç–∞–π–º

–ï—Ç–∞–ø 6. –ü—Ä–æ–¥–∞–∫—à–Ω-—Ñ–ª–æ—É –∑ USPICY CRM —Ç–∞ OpenAI API
	‚Ä¢	[ ] –í–∏–Ω–µ—Å—Ç–∏ —á–∞—Ç-–ª–æ–≥—ñ–∫—É –≤ server-side endpoint, —â–æ–± UI —Å—Ç–∞—Ä—Ç–µ—Ä–∞ –∑–∞–ª–∏—à–∏–≤—Å—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–º —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º —Ä–æ–∑—Ä–æ–±–∫–∏
	‚Ä¢	[ ] –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ USPICY CRM: –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (–≤–µ–±—Ö—É–∫/–ø–æ–ª—ñ–Ω–≥) —Ç–∞ –º–∞–ø—ñ–Ω–≥ —É agent.session
	‚Ä¢	[ ] –í—ñ–¥–ø—Ä–∞–≤–ª—è—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞–∑–∞–¥ —É CRM –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∞–≥–µ–Ω—Ç–æ–º —Å—Ü–µ–Ω–∞—Ä—ñ—é
	‚Ä¢	[ ] –ö–µ—Ä—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª–∞–º–∏: –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ –∑ CRM —É OpenAI Files API —Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è alias
	‚Ä¢	[ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –π –∞—É–¥–∏—Ç: –∑–∞—Ö–∏—Å—Ç–∏—Ç–∏ –ø—Ä–æ–¥–∞–∫—à–Ω endpoint —ñ –ª–æ–≥—É–≤–∞—Ç–∏ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
	‚Ä¢	[ ] End-to-end –¥–µ–º–æ: —Ä–µ–∞–ª—å–Ω–∏–π —á–∞—Ç —É CRM ‚Üí –∞–≥–µ–Ω—Ç ‚Üí –≤—ñ–¥–ø–æ–≤—ñ–¥—å —É —Ç—ñ–∫–µ—Ç—ñ

–ï—Ç–∞–ø 7. –ü—ñ—Å–ª—è MVP (roadmap)
	‚Ä¢	[ ] –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∫—ñ–ª—å–∫–æ—Ö Vector Store (UI-–º—É–ª—å—Ç–∏–≤–∏–±—ñ—Ä + –º–∞—Å–∏–≤ vector_store_ids)
	‚Ä¢	[ ] HITL-—Ä–µ–∂–∏–º —ñ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º/CRM API (book_consultation ‚Üí –∂–∏–≤–µ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è)
	‚Ä¢	[ ] –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è rule-engine, –≤–µ—Ä—Å—É–≤–∞–Ω–Ω—è —Ç–µ–º —Ç–∞ —Ä–µ–≥—Ä–µ—Å-—Ç–µ—Å—Ç–∏ –Ω–∞ –±—ñ–∑–Ω–µ—Å-–∫–µ–π—Å–∏

‚∏ª


–ú–∏–Ω–∏-–ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
	‚Ä¢	–î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω—É —á–∞—Ç –ø—Ä–∞—Ü—é—î –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ USPICY CRM; UI —Å—Ç–∞—Ä—Ç–µ—Ä–∞ —Ç—Ä–∏–º–∞—î–º–æ —è–∫ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –¥–µ–≤-—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç—ñ–≤ —ñ –≤—ñ–¥–ª–∞–¥–∫–∏.
	‚Ä¢	–ì–¥–µ –≤—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ª–æ–≥–∏–∫—É: –æ—Å—Ç–∞–≤–ª—è–µ–º —á–∞—Ç/–ø–∞–Ω–µ–ª—å —Å—Ç–∞—Ä—Ç–µ—Ä–∞ –¥–ª—è –¥–µ–≤-–∑–∞–ø—É—Å–∫—ñ–≤, –∞ –Ω–∞—à–∏ —Ä–æ—É—Ç—ã ‚Äî –≤ /app/api/... (Next.js). –û–Ω–∏ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –∏–∑ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π/handlers, –∫–æ–≥–¥–∞ –º–æ–¥–µ–ª—å —Ä–µ—à–∞–µ—Ç ¬´–≤—ã–∑–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç¬ª.
	‚Ä¢	–í—ã–±–æ—Ä —Ç–µ–º—ã –±–µ–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ç—É–ª–∑–∞: —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è, –ø–æ–ª—É—á–∏–≤ top-k –∏–∑ File Search, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç topicId —Å max —á–∞—Å—Ç–æ—Ç–æ–π; –µ—Å–ª–∏ –Ω–∏—á—å—è ‚Äî –∞–≥–µ–Ω—Ç –∑–∞–¥–∞—ë—Ç —É—Ç–æ—á–Ω–µ–Ω–∏–µ.
	‚Ä¢	–ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä-—Ö—Ä–∞–Ω–∏–ª–∏—â–∞: API –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤ vector_store_ids, –Ω–æ UI —Å—Ç–∞—Ä—Ç–µ—Ä–∞ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ –æ–¥–∏–Ω; –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –¥–µ—Ä–∂–∏–º –æ–¥–∏–Ω —Å—Ç–æ—Ä –∏ —Ä–∞–∑–º–µ—á–∞–µ–º —á–∞–Ω–∫–∏ metadata.topicId. –ü–æ–∑–∂–µ ‚Äî –¥–æ–±–∞–≤–∏–º –º—É–ª—å—Ç–∏-—Å—Ç–æ—Ä (–∫–æ–¥–æ–≤–æ–π –ø—Ä–∞–≤–∫–æ–π).  Ôøº
